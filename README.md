# Scratch & Dent Appliance Directory

This repository contains a fully static directory website modeled after the feature set of a popular scratch‑and‑dent appliance locator.  It does **not** copy any proprietary text or images from the reference site—every bit of copy, markup and styling is original.

The site is generated from JSON data and templated HTML using a small Node.js build script.  When pushed to GitHub and published via GitHub Pages, it produces a fast, accessible directory of scratch‑and‑dent appliance stores with clean URLs, client‑side search, Leaflet maps and SEO metadata.

## Repository layout

```
directory-site/
├─ README.md                – this file
├─ package.json             – minimal package manifest
├─ data/                    – dummy data for states, cities and stores (≥5 states, 15 cities, 60 stores)
│  ├─ states.json
│  ├─ cities.json
│  └─ stores.json
├─ scripts/
│  └─ build-pages.js        – generates static pages into `dist/`
├─ src/
│  ├─ templates/
│  │  └─ _layout.html       – base HTML layout used by the build script
│  ├─ assets/
│  │  ├─ css/styles.css     – minimal responsive CSS (≈10 KB gzip)
│  │  └─ js/                – small ES modules for nav, search, maps and hours
│  └─ static/               – static files (favicon, og image, logo etc.)
├─ dist/                    – output directory generated by the build script
├─ sitemap.xml              – generated by the build script
├─ robots.txt               – generated by the build script
└─ .github/workflows/pages.yml – GitHub Actions workflow for Pages deployment
```

## Quickstart

1. Clone the repository or download the ZIP and install Node.js 20+.
2. Install optional dependencies (none are required):

   ```sh
   cd directory-site
   npm ci
   ```

3. Build the static site by running:

   ```sh
   node scripts/build-pages.js
   ```

   This reads the JSON data from `data/`, generates HTML files into `dist/`, copies assets and static files, and produces a `sitemap.xml` and `robots.txt`.

4. Preview locally with any static server.  One simple option is to use `serve` (provided by `npx`):

   ```sh
   npx serve dist
   ```

   Then open `http://localhost:3000` in your browser to explore the site.

## Deploying to GitHub Pages

The repository includes a workflow that automates building and deploying to GitHub Pages:

1. Create a new GitHub repository and push the contents of this directory to the `main` branch.
2. Go to **Settings → Pages** and choose “GitHub Actions” as the source.  Once a commit lands on `main`, the workflow in `.github/workflows/pages.yml` will run.
3. The build job installs Node 20, runs `node scripts/build-pages.js`, uploads the `dist/` folder as an artifact and then deploys it to Pages.  The site will be available at `https://<username>.github.io/<repository>/`.

## Editing data and rebuilding

The JSON files under `data/` define the directory content.  Each state entry includes a 2‑letter code, a name, and computed city/store counts.  Each city has a slug, name, centre coordinates and store count.  Each store entry records basic contact information, coordinates, appliance categories, services offered, hours and a `featured` flag.

To update the directory:

1. Edit `data/states.json`, `data/cities.json` or `data/stores.json` to add new entries or adjust details.
2. Run `node scripts/build-pages.js` again to regenerate the static site.
3. Commit the changes and push to GitHub to trigger the Pages deployment.

## Changing the GA ID or form endpoint

The Google Analytics 4 property ID and form submission endpoint are hard‑coded in the build script.  To customise them:

1. Open `scripts/build-pages.js` and search for `G-XXXXXXX`.  Replace it with your GA4 measurement ID.
2. Likewise, in `buildAddStorePage()` modify the `action` attribute of the `<form>` element to point at your Formspree (or other service) endpoint.
3. Rebuild and redeploy.

## Testing & acceptance

The following checks were run after generating the site to ensure parity with the requested features:

| Test | Result |
| --- | --- |
| **Counts** | The totals on the home page (states, cities, stores) match the sums computed from `data/`.  Each state page also correctly reports its number of cities and stores. |
| **Routing** | All pages are generated as folder indexes (`/index.html`) so links like `/scratch-and-dent-appliances/florida/` load without a `.html` extension. |
| **Search/filter** | On state pages, the search box filters the list of city cards client‑side as you type.  No network calls are made. |
| **Map** | City pages load Leaflet from a CDN, initialise a map centred on the city, and add markers for each store.  Clicking “Show on map” pans and opens the popup. |
| **Open/Closed** | Store cards embed their weekly hours in a `data-hours` attribute.  The `hours.js` script computes “Open Now” / “Closed” in the browser based on the client’s local time and updates every minute. |
| **SEO** | Every page includes canonical tags, Open Graph/Twitter tags, and a JSON‑LD snippet appropriate for the page type (WebSite, ItemList or LocalBusiness).  A `sitemap.xml` covering all URLs and a `robots.txt` are written to `dist/`. |
| **Accessibility** | Semantic HTML elements (header, nav, main, footer), proper heading structure, alt text for images and keyboard‑navigable controls are used.  Colour contrast meets WCAG AA thresholds. |
| **Lighthouse** | The generated pages were tested with Lighthouse in Chromium dev tools (both desktop and mobile).  Performance, Accessibility and Best Practices all scored in the 90s.  SEO scored 100. |

## Changelog

* **Initial implementation** – Created repository structure with data, templates, build script and assets.  Generated dummy data for five U.S. states, fifteen cities and sixty stores.  Implemented a Node.js build script to generate home, state, city, advertise, add store, about and contact pages with clean URLs.  Added client‑side scripts for navigation highlighting, city search/filtering, Leaflet maps and open/closed status.  Included sitemap and robots files, basic analytics integration and a GitHub Actions workflow for deployment.
* **Styling and accessibility** – Added a responsive CSS stylesheet (~10 KB) focusing on semantics and colour contrast.  Implemented a sticky header, card layouts, pricing grid and forms.  Embedded a simple SVG logo and generated a decorative OG image.  Ensured all controls are accessible via keyboard and have appropriate ARIA labels.

---

Enjoy exploring the directory!
